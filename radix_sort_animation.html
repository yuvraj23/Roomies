<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Radix Sort Complete Visualization</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            color: white;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            text-align: center;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .control-panel {
            margin-bottom: 30px;
        }

        .start-btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            border: none;
            padding: 15px 30px;
            font-size: 1.2em;
            color: white;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .start-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .start-btn:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
        }

        .info-panel {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
        }

        .current-step {
            font-size: 1.3em;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .digit-info {
            font-size: 1.1em;
            color: #ffd700;
        }

        .array-container {
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }

        .array-label {
            font-size: 1.2em;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .array-display {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }

        .number-box {
            background: linear-gradient(45deg, #4ecdc4, #26a69a);
            color: white;
            padding: 15px;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            min-width: 60px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            transition: all 0.5s ease;
            position: relative;
        }

        .number-box.highlight {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(255,107,107,0.4);
        }

        .digit-highlight {
            position: absolute;
            bottom: -5px;
            left: 50%;
            transform: translateX(-50%);
            background: #ffd700;
            color: #333;
            padding: 2px 6px;
            border-radius: 5px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .arrays-column {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 20px;
        }

        .freq-container, .prefix-container {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .array-grid {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 8px;
            margin-top: 15px;
        }

        .array-cell {
            background: rgba(255,255,255,0.2);
            padding: 10px;
            border-radius: 8px;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .array-cell.active {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #333;
            transform: scale(1.1);
        }

        .array-index {
            font-size: 0.8em;
            color: #ccc;
            margin-bottom: 5px;
        }

        .sorting-container {
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }

        .sorting-process {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            align-items: start;
        }

        .original-array, .sorted-array {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .array-item {
            background: linear-gradient(45deg, #a8e6cf, #88d8c0);
            color: #333;
            padding: 10px 15px;
            border-radius: 8px;
            font-weight: bold;
            transition: all 0.5s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .array-item.moving {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            transform: translateX(20px);
        }

        .item-digit {
            background: rgba(255,255,255,0.3);
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.9em;
        }

        .explanation {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            backdrop-filter: blur(10px);
            text-align: left;
        }

        .step-details {
            font-size: 1.1em;
            line-height: 1.6;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-in {
            animation: slideIn 0.5s ease;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .pulse {
            animation: pulse 1s ease infinite;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ”¢ Complete Radix Sort Visualization</h1>
        
        <div class="control-panel">
            <button id="startBtn" class="start-btn">Start Animation</button>
        </div>

        <div class="info-panel">
            <div id="currentStep" class="current-step">Click Start to begin the animation</div>
            <div id="digitInfo" class="digit-info">This will show frequency array, prefix sum, and sorting steps</div>
        </div>

        <div class="array-container">
            <div class="array-label">Current Array State</div>
            <div id="arrayDisplay" class="array-display"></div>
        </div>

        <div id="freqPrefixContainer" class="arrays-column hidden">
            <div class="freq-container">
                <div class="array-label">Frequency Array (Count of each digit 0-9)</div>
                <div class="array-grid" id="freqArray"></div>
            </div>
            <div class="prefix-container">
                <div class="array-label">Prefix Sum Array (Cumulative positions)</div>
                <div class="array-grid" id="prefixArray"></div>
            </div>
        </div>

        <div id="sortingContainer" class="sorting-container hidden">
            <div class="array-label">Counting Sort Process (Right to Left)</div>
            <div class="sorting-process">
                <div>
                    <h3>Original Order</h3>
                    <div id="originalList" class="original-array"></div>
                </div>
                <div>
                    <h3>Sorted Result</h3>
                    <div id="sortedList" class="sorted-array"></div>
                </div>
            </div>
        </div>

        <div class="explanation">
            <div id="stepDetails" class="step-details">
                <strong>Complete Radix Sort Process:</strong><br>
                1. <strong>Frequency Array:</strong> Count occurrences of each digit (0-9)<br>
                2. <strong>Prefix Sum:</strong> Convert frequencies to cumulative positions<br>
                3. <strong>Stable Sorting:</strong> Place elements in correct positions (right-to-left)<br>
                4. <strong>Repeat:</strong> Process next digit position
            </div>
        </div>
    </div>

    <script>
        class CompleteRadixSortVisualizer {
            constructor() {
                // Better array for demonstration
                this.originalArray = [170, 45, 75, 90, 2, 802, 24, 66];
                this.currentArray = [...this.originalArray];
                this.currentStep = 0;
                this.isAnimating = false;
                this.digitPosition = 1;
                
                this.startBtn = document.getElementById('startBtn');
                this.arrayDisplay = document.getElementById('arrayDisplay');
                this.currentStepEl = document.getElementById('currentStep');
                this.digitInfoEl = document.getElementById('digitInfo');
                this.freqPrefixContainer = document.getElementById('freqPrefixContainer');
                this.freqArray = document.getElementById('freqArray');
                this.prefixArray = document.getElementById('prefixArray');
                this.sortingContainer = document.getElementById('sortingContainer');
                this.originalList = document.getElementById('originalList');
                this.sortedList = document.getElementById('sortedList');
                this.stepDetailsEl = document.getElementById('stepDetails');
                
                this.startBtn.addEventListener('click', () => this.startAnimation());
                
                this.displayArray();
            }

            displayArray(highlightDigit = false) {
                this.arrayDisplay.innerHTML = '';
                this.currentArray.forEach((num, index) => {
                    const box = document.createElement('div');
                    box.className = 'number-box animate-in';
                    box.textContent = num;
                    
                    if (highlightDigit) {
                        const digit = Math.floor(num / this.digitPosition) % 10;
                        const digitEl = document.createElement('div');
                        digitEl.className = 'digit-highlight';
                        digitEl.textContent = digit;
                        box.appendChild(digitEl);
                        box.classList.add('highlight');
                    }
                    
                    this.arrayDisplay.appendChild(box);
                });
            }

            displayFrequencyArray(frequencies) {
                this.freqArray.innerHTML = '';
                for (let i = 0; i < 10; i++) {
                    const cell = document.createElement('div');
                    cell.className = 'array-cell';
                    cell.innerHTML = `
                        <div class="array-index">[${i}]</div>
                        <div>${frequencies[i] || 0}</div>
                    `;
                    this.freqArray.appendChild(cell);
                }
            }

            displayPrefixArray(prefixSums) {
                this.prefixArray.innerHTML = '';
                for (let i = 0; i < 10; i++) {
                    const cell = document.createElement('div');
                    cell.className = 'array-cell';
                    cell.innerHTML = `
                        <div class="array-index">[${i}]</div>
                        <div>${prefixSums[i] || 0}</div>
                    `;
                    this.prefixArray.appendChild(cell);
                }
            }

            highlightFreqCell(digit) {
                const cells = this.freqArray.children;
                // Remove previous highlights
                for (let cell of cells) {
                    cell.classList.remove('active');
                }
                if (digit >= 0 && digit < 10) {
                    cells[digit].classList.add('active');
                }
            }

            highlightPrefixCell(digit) {
                const cells = this.prefixArray.children;
                // Remove previous highlights
                for (let cell of cells) {
                    cell.classList.remove('active');
                }
                if (digit >= 0 && digit < 10) {
                    cells[digit].classList.add('active');
                }
            }

            setupSortingLists() {
                this.originalList.innerHTML = '';
                this.sortedList.innerHTML = '';
                
                // Show original array
                this.currentArray.forEach((num, index) => {
                    const item = document.createElement('div');
                    item.className = 'array-item';
                    item.id = `original-${index}`;
                    const digit = Math.floor(num / this.digitPosition) % 10;
                    item.innerHTML = `
                        <span>${num}</span>
                        <span class="item-digit">digit: ${digit}</span>
                    `;
                    this.originalList.appendChild(item);
                });
            }

            getDigitName(position) {
                if (position === 1) return 'Units';
                if (position === 10) return 'Tens';
                if (position === 100) return 'Hundreds';
                return `${position}s`;
            }

            async startAnimation() {
                if (this.isAnimating) return;
                
                this.isAnimating = true;
                this.startBtn.disabled = true;
                this.currentArray = [...this.originalArray];
                this.digitPosition = 1;
                
                // Hide containers initially
                this.freqPrefixContainer.classList.add('hidden');
                this.sortingContainer.classList.add('hidden');
                
                this.currentStepEl.textContent = "Starting Complete Radix Sort Animation...";
                this.stepDetailsEl.innerHTML = "<strong>Starting:</strong> We'll sort [170, 45, 75, 90, 2, 802, 24, 66] using Radix Sort with complete internal steps.";
                
                await this.sleep(2000);
                
                // Find max number
                const maxNumber = Math.max(...this.currentArray);
                this.currentStepEl.textContent = `Maximum number: ${maxNumber} (${maxNumber.toString().length} digits)`;
                this.stepDetailsEl.innerHTML = `<strong>Analysis:</strong> Maximum number is ${maxNumber}, which has ${maxNumber.toString().length} digits. We need ${maxNumber.toString().length} passes through the algorithm.`;
                
                await this.sleep(2000);
                
                // Process each digit position
                let tempMax = maxNumber;
                while (tempMax > 0) {
                    await this.completeDigitSort();
                    tempMax = Math.floor(tempMax / 10);
                    this.digitPosition *= 10;
                }
                
                // Final result
                this.freqPrefixContainer.classList.add('hidden');
                this.sortingContainer.classList.add('hidden');
                this.currentStepEl.textContent = "âœ… Radix Sort Complete!";
                this.digitInfoEl.textContent = "Array is now fully sorted: [" + this.currentArray.join(', ') + "]";
                this.stepDetailsEl.innerHTML = "<strong>Completed!</strong> The array has been successfully sorted using Radix Sort. Each digit position was processed with frequency counting, prefix sums, and stable sorting.";
                
                this.displayArray();
                
                this.startBtn.disabled = false;
                this.isAnimating = false;
            }

            async completeDigitSort() {
                const digitName = this.getDigitName(this.digitPosition);
                
                // Step 1: Show current digit being processed
                this.currentStepEl.textContent = `Step 1: Processing ${digitName} Place`;
                this.digitInfoEl.textContent = `Extracting ${digitName.toLowerCase()} digit from each number`;
                this.stepDetailsEl.innerHTML = `<strong>Step 1 - Extract Digits:</strong> We're processing the ${digitName.toLowerCase()} place (divisor = ${this.digitPosition}). Each number's ${digitName.toLowerCase()} digit will be highlighted.`;
                
                this.displayArray(true);
                await this.sleep(3000);
                
                // Step 2: Build frequency array
                this.currentStepEl.textContent = `Step 2: Building Frequency Array`;
                this.digitInfoEl.textContent = `Counting how many numbers have each digit (0-9)`;
                this.stepDetailsEl.innerHTML = `<strong>Step 2 - Frequency Count:</strong> Count how many numbers have each digit (0-9) in the ${digitName.toLowerCase()} position.`;
                
                this.freqPrefixContainer.classList.remove('hidden');
                
                const frequencies = new Array(10).fill(0);
                this.displayFrequencyArray(frequencies);
                
                // Count frequencies with animation
                for (let i = 0; i < this.currentArray.length; i++) {
                    const num = this.currentArray[i];
                    const digit = Math.floor(num / this.digitPosition) % 10;
                    frequencies[digit]++;
                    
                    this.highlightFreqCell(digit);
                    this.displayFrequencyArray(frequencies);
                    await this.sleep(800);
                }
                
                await this.sleep(1500);
                
                // Step 3: Build prefix sum array
                this.currentStepEl.textContent = `Step 3: Building Prefix Sum Array`;
                this.digitInfoEl.textContent = `Converting frequencies to cumulative positions`;
                this.stepDetailsEl.innerHTML = `<strong>Step 3 - Prefix Sums:</strong> Convert frequency counts to cumulative positions. Each value shows where elements with that digit should end up.`;
                
                const prefixSums = [...frequencies];
                this.displayPrefixArray(prefixSums);
                
                // Build prefix sums with animation
                for (let i = 1; i < 10; i++) {
                    prefixSums[i] = prefixSums[i] + prefixSums[i - 1];
                    this.highlightPrefixCell(i);
                    this.displayPrefixArray(prefixSums);
                    await this.sleep(800);
                }
                
                await this.sleep(1500);
                
                // Step 4: Stable sorting process
                this.currentStepEl.textContent = `Step 4: Stable Sorting (Right to Left)`;
                this.digitInfoEl.textContent = `Placing elements in correct positions using prefix sums`;
                this.stepDetailsEl.innerHTML = `<strong>Step 4 - Stable Sort:</strong> Process elements from right to left, using prefix sums to place each element in its correct position while maintaining stability.`;
                
                this.sortingContainer.classList.remove('hidden');
                this.setupSortingLists();
                
                const sortedArray = new Array(this.currentArray.length);
                const workingPrefixSums = [...prefixSums];
                
                // Process from right to left for stability
                for (let i = this.currentArray.length - 1; i >= 0; i--) {
                    const num = this.currentArray[i];
                    const digit = Math.floor(num / this.digitPosition) % 10;
                    const correctIndex = workingPrefixSums[digit] - 1;
                    
                    // Highlight current element
                    const originalItem = document.getElementById(`original-${i}`);
                    if (originalItem) {
                        originalItem.classList.add('moving');
                    }
                    
                    // Highlight prefix sum being used
                    this.highlightPrefixCell(digit);
                    
                    await this.sleep(1000);
                    
                    // Add to sorted list
                    const sortedItem = document.createElement('div');
                    sortedItem.className = 'array-item animate-in';
                    sortedItem.innerHTML = `
                        <span>${num}</span>
                        <span class="item-digit">pos: ${correctIndex}</span>
                    `;
                    
                    // Insert at correct visual position
                    const existingItems = this.sortedList.children;
                    if (correctIndex < existingItems.length) {
                        this.sortedList.insertBefore(sortedItem, existingItems[correctIndex]);
                    } else {
                        this.sortedList.appendChild(sortedItem);
                    }
                    
                    sortedArray[correctIndex] = num;
                    workingPrefixSums[digit]--;
                    
                    // Update prefix sum display
                    this.displayPrefixArray(workingPrefixSums);
                    
                    await this.sleep(1500);
                    
                    if (originalItem) {
                        originalItem.classList.remove('moving');
                    }
                }
                
                // Update current array
                this.currentArray = sortedArray;
                
                await this.sleep(2000);
                
                // Show final state for this digit
                this.currentStepEl.textContent = `${digitName} Place Complete`;
                this.digitInfoEl.textContent = `Result: [${this.currentArray.join(', ')}]`;
                this.displayArray();
                
                await this.sleep(2000);
                
                // Hide detail containers for next iteration
                this.freqPrefixContainer.classList.add('hidden');
                this.sortingContainer.classList.add('hidden');
            }

            sleep(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
        }

        // Initialize the visualizer when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            new CompleteRadixSortVisualizer();
        });
    </script>
</body>
</html>